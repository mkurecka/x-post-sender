#:schema node_modules/wrangler/config-schema.json
name = "text-processor-api"
main = "src/index.ts"
compatibility_date = "2025-01-20"
compatibility_flags = ["nodejs_compat"]

# Bindings
[[ d1_databases ]]
binding = "DB"
database_name = "text-processor-db"
database_id = "b70b21ae-9fa2-4464-b3fd-9d4eeea7548a"

[[ kv_namespaces ]]
binding = "CACHE"
id = "b52a33acf7114a3e842d575b830b980e"

[[ kv_namespaces ]]
binding = "SESSIONS"
id = "7d68ad4ef5c14fe1aaaa981c50c15597"

[[ r2_buckets ]]
binding = "STORAGE"
bucket_name = "text-processor-storage"

# Environment Variables
[vars]
ENVIRONMENT = "development"
JWT_SECRET = "change-this-in-production"
API_VERSION = "v1"
APP_URL = "https://text-processor.app"
AIRTABLE_API_KEY = "" # Add your Airtable API key here
AIRTABLE_BASE_ID = "" # Add your Airtable base ID here
AIRTABLE_PROFILES_TABLE = "User Profiles" # Table name for user profiles
AIRTABLE_WEBSITES_TABLE = "Websites" # Table name for websites
HTML_TO_IMAGE_WORKER_URL = "https://html-to-image-worker.kureckamichal.workers.dev/render"
RAILWAY_WEBHOOK_URL = "https://primary-production-3ce13.up.railway.app/api/v1/webhook"
# Note: OPENROUTER_API_KEY and HTML_TO_IMAGE_WORKER_API_KEY are set as secrets via Cloudflare Dashboard
# Do not add them here as environment variables or they will override the secrets

# Service Bindings - for Worker-to-Worker communication
[[services]]
binding = "HTML_TO_IMAGE_SERVICE"
service = "html-to-image-worker"

# Observability
[observability]
enabled = true
